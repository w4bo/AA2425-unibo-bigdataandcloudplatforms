<!DOCTYPE html>
<html lang="en"><head>
<script src="06-storage_files/libs/quarto-html/tabby.min.js"></script>
<script src="06-storage_files/libs/quarto-html/popper.min.js"></script>
<script src="06-storage_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="06-storage_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="06-storage_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="06-storage_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="06-storage_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.4.549">

  <meta name="author" content="Matteo Francia   DISI — University of Bologna   m.francia@unibo.it">
  <title>Big Data and Cloud Platforms (Module 2)</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="06-storage_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="06-storage_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="06-storage_files/libs/revealjs/dist/theme/quarto.css">
  <link href="06-storage_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="06-storage_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="06-storage_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="06-storage_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Big Data and Cloud Platforms (Module 2)</h1>
  <p class="subtitle">Data pipelines on cloud (Storage)</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Matteo Francia <br> DISI — University of Bologna <br> m.francia@unibo.it 
</div>
</div>
</div>

</section>
<section id="section" class="title-slide slide level1 center">
<h1></h1>

<img data-src="imgs/249.svg" class="r-stretch quarto-figure-center"><p class="caption">Storage</p></section>

<section id="storage" class="title-slide slide level1 center">
<h1>Storage</h1>
<p><strong>Goal</strong>: persisting data</p>
<p>What storage do we choose?</p>
<ul>
<li><strong>Storage model</strong> (or data model) ~= variety
<ul>
<li>How data are organized/accessed in a storage system
<ul>
<li>Structured vs unstructured</li>
<li>Data access model (key-value, column, etc.)</li>
</ul></li>
</ul></li>
<li>Access <strong>frequency</strong></li>
<li><strong>Analyses</strong> to be performed</li>
</ul>
</section>

<section id="storage-models" class="title-slide slide level1 center">
<h1>Storage models</h1>

<img data-src="imgs/252.svg" class="r-stretch quarto-figure-center"><p class="caption">Taxonomy of storage models <span class="citation" data-cites="mansouri2017data">(<a href="#/references" role="doc-biblioref" onclick="">Mansouri, Toosi, and Buyya 2017</a>)</span></p></section>

<section id="storage-models-aws" class="title-slide slide level1 center">
<h1>Storage models (AWS)</h1>
<table>
<thead>
<tr class="header">
<th style="text-align: center;"><em>Data structure</em></th>
<th style="text-align: center;"><em>Data structure</em></th>
<th style="text-align: center;"><em>Data structure</em></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Structured</td>
<td style="text-align: center;">Database</td>
<td style="text-align: center;">Relational</td>
</tr>
</tbody>
</table>
<p><br></p>
<div class="columns">
<div class="column" style="width:60%;">
<p><strong>Relational database</strong></p>
<ul>
<li>Store data with predefined schemas and relationships between them</li>
<li>Support ACID transactions</li>
<li>Maintain referential integrity</li>
</ul>
</div><div class="column" style="width:40%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imgs/253.svg"></p>
<figcaption><a href="https://aws.amazon.com/products/databases/">AWS databases</a></figcaption>
</figure>
</div>
</div>
</div>
</section>

<section id="storage-models-aws-1" class="title-slide slide level1 center">
<h1>Storage models (AWS)</h1>
<table>
<thead>
<tr class="header">
<th style="text-align: center;"><em>Data structure</em></th>
<th style="text-align: center;"><em>Data structure</em></th>
<th style="text-align: center;"><em>Data structure</em></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Semi/unstructured</td>
<td style="text-align: center;">Database</td>
<td style="text-align: center;">*</td>
</tr>
</tbody>
</table>
<p><br></p>
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li><strong>Key/value</strong>: store and retrieve large volumes of data</li>
<li><strong>Document</strong>: store semi-structured data as JSON-like documents</li>
<li><strong>Wide column</strong>: use tables but unlike a relational database, columns can vary from row to row in the same table</li>
<li><strong>Graph</strong>: navigate and query relationships between highly connected datasets</li>
<li>… and more</li>
</ul>
</div><div class="column" style="width:40%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imgs/254.svg"></p>
<figcaption><a href="https://aws.amazon.com/products/databases/">AWS databases</a></figcaption>
</figure>
</div>
</div>
</div>
</section>

<section id="storage-models-google-cloud" class="title-slide slide level1 center">
<h1>Storage models (<a href="https://cloud.google.com/products/databases">Google Cloud</a>)</h1>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="imgs/slides188.png"></p>
</div><div class="column" style="width:50%;">
<p><img data-src="imgs/slides189.png"></p>
</div>
</div>
</section>

<section id="storage-models-aws-2" class="title-slide slide level1 center">
<h1>Storage models (AWS)</h1>
<table>
<thead>
<tr class="header">
<th style="text-align: center;"><em>Data structure</em></th>
<th style="text-align: center;"><em>Data structure</em></th>
<th style="text-align: center;"><em>Data structure</em></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Unstructured</td>
<td style="text-align: center;">File/Database</td>
<td style="text-align: center;">Key-value</td>
</tr>
</tbody>
</table>
<p><br></p>
<p><strong>File system</strong> (EFS), <strong>object storage</strong> (S3) (or <strong>DB K-V</strong> ; e.g., DynamoDB)</p>
<ul>
<li>Handle unstructured data</li>
<li>… organized as files (or blob)</li>
<li>… accessed using a key-value</li>
</ul>
<p><em>Differ in the supported features</em></p>
<ul>
<li>E.g., maximum item size (DynamoDB: 400KB, S3: 5TB)</li>
<li>E.g., indexes, querying mechanisms, latency, etc.</li>
</ul>
</section>

<section id="aws-simple-storage-service-s3" class="title-slide slide level1 center">
<h1>AWS Simple Storage Service (S3)</h1>
<p><strong>Simple Storage Service (S3)</strong></p>
<ul>
<li><em>Serverless</em> storage, save data as <strong>objects</strong> within <strong>buckets</strong></li>
<li>An <strong>object</strong> is composed of a file and any metadata that describes that file (e.g., <strong>object key</strong>)</li>
<li><strong>Buckets</strong> are logical containers for objects
<ul>
<li>You can have one or more buckets in your account</li>
<li>Control access for each bucket individually</li>
<li>Choose the geographical region where Amazon S3 will store the bucket and its contents</li>
</ul></li>
</ul>
<p>Benefits</p>
<ul>
<li>Unified data architecture
<ul>
<li>Build a multi-tenant environment, where many users can bring their data</li>
<li>Improve both cost and data governance over traditional solutions</li>
</ul></li>
<li><em>Decoupling of storage from computing and data processing</em>
<ul>
<li>You can cost-effectively store all data types in their native formats</li>
<li>Then, launch transformations as you need</li>
</ul></li>
</ul>
</section>

<section id="storage-access-frequency-aws" class="title-slide slide level1 center">
<h1>Storage: access frequency (AWS)</h1>
<div class="columns">
<div class="column" style="width:60%;">
<p>AWS S3: <a href="https://aws.amazon.com/s3/storage-classes/">storage classes</a></p>
<ul>
<li><em>Standard</em>: general purpose</li>
<li><em>Infrequent (rapid) access</em></li>
<li><em>One Zone-IA</em>: lower-cost option for infrequently accessed data that do not require high availability and resilience</li>
<li><em>Glacier</em>: low-cost storage class for data archiving, three retrieval options that range from a few minutes to hours</li>
<li><em>Deep Glacier</em>: long-term retention for data accessed once/twice a year.
<ul>
<li>E.g., retain data sets for 10 years or longer</li>
</ul></li>
<li><em>Intelligent-Tiering</em>: move objects between access tiers when access patterns change</li>
</ul>
</div><div class="column" style="width:40%;">
<p><img data-src="imgs/258.svg"></p>
</div>
</div>
</section>

<section id="storage-access-frequency-aws-1" class="title-slide slide level1 center">
<h1>Storage: access frequency (AWS)</h1>
<div class="columns">
<div class="column" style="width:60%;">
<p><a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/object-lifecycle-mgmt.html">Object lifecycle management</a></p>
<ul>
<li>Rules that define actions that Amazon S3 applies to a group of objects</li>
</ul>
<p>Two types of actions:</p>
<ul>
<li><em>Transition</em>: when objects transition to another storage class.
<ul>
<li>E.g., archive objects to the S3 Glacier storage 1 year after creating them</li>
</ul></li>
<li><em>Expiration</em>: when objects expire.
<ul>
<li>Amazon S3 deletes expired objects on your behalf</li>
</ul></li>
</ul>
</div><div class="column" style="width:40%;">
<p><img data-src="imgs/259.svg"></p>
</div>
</div>
</section>

<section id="storage-access-frequency-google-cloud" class="title-slide slide level1 center">
<h1>Storage: access frequency (<a href="https://cloud.google.com/blog/products/storage-data-transfer/archive-storage-class-for-coldest-data-now-available">Google Cloud</a>)</h1>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="imgs/slides192.png"></p>
</div><div class="column" style="width:50%;">
<p><img data-src="imgs/slides193.png"></p>
</div>
</div>
</section>

<section id="organizing-the-data-lake" class="title-slide slide level1 center">
<h1>Organizing the data lake</h1>

</section>

<section id="organizing-the-data-lake-1" class="title-slide slide level1 center">
<h1>Organizing the data lake</h1>
<div class="columns">
<div class="column" style="width:60%;">
<p>Having consistent principles on how to organize your data is important</p>
<ul>
<li>To build standardized pipelines with the same design with regard to where read/write data</li>
<li>Standardization makes it easier to manage your pipelines at scale</li>
<li>Helps data users search for data in the storage and understand exactly what they need</li>
<li>Decoupling storage from processing</li>
</ul>
</div><div class="column" style="width:40%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imgs/261.svg"></p>
<figcaption>Areas</figcaption>
</figure>
</div>
</div>
</div>
</section>

<section id="organizing-the-data-lake-2" class="title-slide slide level1 center">
<h1>Organizing the data lake</h1>
<div class="columns">
<div class="column" style="width:60%;">
<p><strong>Landing area (LA)</strong></p>
<ul>
<li>Save <em>raw data</em> from ingestion</li>
<li>Transient, data is not stored for long term</li>
</ul>
<p><strong>Staging area (SA)</strong></p>
<ul>
<li>Raw data goes through a set of common transformations: ensuring <em>basic quality</em> and making sure it <em>conforms to existing schemas</em> for this data source and then data is saved into SA</li>
</ul>
<p><strong>Archive area (AA)</strong></p>
<ul>
<li>After saving into SA, raw data from LA should be <em>copied into the archive</em> to reprocess any given batch of data by simply copying it from AA into LA</li>
<li>Useful for debugging and testing</li>
</ul>
</div><div class="column" style="width:40%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imgs/262.svg"></p>
<figcaption>Areas</figcaption>
</figure>
</div>
</div>
</div>
</section>

<section id="organizing-the-data-lake-3" class="title-slide slide level1 center">
<h1>Organizing the data lake</h1>
<div class="columns">
<div class="column" style="width:60%;">
<p><strong>Production area (PA)</strong></p>
<ul>
<li>Apply the business logic to data from SA</li>
</ul>
<p><strong>Pass-through job</strong></p>
<ul>
<li>Copy data from SA to PA and then into DWH without applying any business logic</li>
<li>Having a data set in the data warehouse and PA that is a replica can be helpful when debugging any issues with the business logic</li>
</ul>
<p><strong>Cloud data warehouse (DWH)</strong></p>
<p><strong>Failed area (FA)</strong></p>
<ul>
<li>You need to be able to deal with all kinds of errors and failures</li>
<li>There might be bugs in the pipeline code, and cloud resources may fail</li>
</ul>
</div><div class="column" style="width:40%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imgs/263.svg"></p>
<figcaption>Areas</figcaption>
</figure>
</div>
</div>
</div>
</section>

<section id="organizing-the-data-lake-4" class="title-slide slide level1 center">
<h1>Organizing the data lake</h1>
<table>
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Area</th>
<th style="text-align: center;">Permissions</th>
<th style="text-align: center;">Tier</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Landing</td>
<td style="text-align: center;">Ingestion applications can write<br>Scheduled pipelines can read<br>Data consumers can’t access</td>
<td style="text-align: center;"><strong>Hot</strong></td>
</tr>
<tr class="even">
<td style="text-align: center;">Staging</td>
<td style="text-align: center;">Scheduled pipelines can read/write<br>Selected data consumers can read</td>
<td style="text-align: center;"><strong>Hot</strong></td>
</tr>
<tr class="odd">
<td style="text-align: center;">Production</td>
<td style="text-align: center;">Scheduled pipelines can read/write<br>Selected data consumers can read</td>
<td style="text-align: center;"><strong>Hot</strong></td>
</tr>
<tr class="even">
<td style="text-align: center;">Archive</td>
<td style="text-align: center;">Scheduled pipelines can write<br>Dedicated data reprocessing pipelines can read</td>
<td style="text-align: center;"><em>Cold</em>/<em>Archive</em></td>
</tr>
<tr class="odd">
<td style="text-align: center;">Failed</td>
<td style="text-align: center;">Scheduled pipelines can write<br>Dedicated data reprocessing pipelines can read<br>Data consumers don’t have access</td>
<td style="text-align: center;"><strong>Hot</strong></td>
</tr>
</tbody>
</table>
</section>

<section id="organizing-the-data-lake-5" class="title-slide slide level1 center">
<h1>Organizing the data lake</h1>
<p>Alternative organizations are available</p>
<div class="columns">
<div class="column" style="width:60%;">
<blockquote>
<p>“A data lake is a central repository system for storage, processing, and analysis of raw data, in which the data is <strong>kept in its original format </strong> and is processed to be queried only when needed. It can store a <strong>varied amount of formats </strong> in big data ecosystems, from unstructured, semi-structured, to structured data sources.”</p>
<p><span class="citation" data-cites="couto2019mapping">(<a href="#/references" role="doc-biblioref" onclick="">Couto et al. 2019</a>)</span></p>
</blockquote>
</div><div class="column" style="width:40%;">
<p><img data-src="imgs/266.svg"></p>
</div>
</div>
</section>

<section id="organizing-the-data-lake-6" class="title-slide slide level1 center">
<h1>Organizing the data lake</h1>
<p>Use folders to organize data inside areas into a logical structure</p>
<ul>
<li><em>Namespace</em>
<ul>
<li>Logically group multiple pipelines together.</li>
</ul></li>
<li><em>Pipeline name</em>
<ul>
<li>Each data pipeline should have a name that reflects its purpose. For example
<ul>
<li>A pipeline that takes data from the LA, applies common processing steps and saves data into SA</li>
<li>You will also have one for archiving data into AA</li>
</ul></li>
</ul></li>
<li><em>Data source name</em>
<ul>
<li>The ingestion layer will assign a name to each data source you bring into the platform</li>
</ul></li>
<li><em>BatchId</em>
<ul>
<li>Unique identifier for any batch of data that is saved into LA</li>
<li>E.g., Since only ingestion can write to LA, it is its responsibility to generate this identifier</li>
<li>A common choice for this type of identifier is a Universally Unique Identifier (UUID)</li>
</ul></li>
</ul>
<p>Different areas will have slightly different folder structures</p>
<ul>
<li>/landing/ETL/sales_oracle_ingest/customers/01DFTFX89YDFAXREPJTR94</li>
</ul>
</section>

<section id="data-lakehouse" class="title-slide slide level1 center">
<h1>Data Lakehouse</h1>

</section>

<section id="data-lakehouse-1" class="title-slide slide level1 center">
<h1>Data Lakehouse</h1>
<p>Combine the key benefits of data lakes and data warehouses</p>
<ul>
<li>Low-cost storage in an open format accessible by a variety of systems from the former</li>
<li>Powerful management and optimization features from the latter
<ul>
<li>ACID transactions, data versioning, auditing, indexing, caching, and query optimization.</li>
</ul></li>
</ul>
<p><em>Key question: can we effectively combine these benefits?</em></p>
<ul>
<li><strong>Lakehouses</strong> are a good fit for cloud environments with separate computing and storage</li>
<li>Applications can run on-demand on separate computing nodes while accessing data in storage nodes</li>
</ul>
</section>

<section id="data-independence" class="title-slide slide level1 center">
<h1>Data Independence</h1>
<div class="columns">
<div class="column" style="width:60%;">
<p><strong>Data independence</strong>: modify the schema at one level of the database system without altering the schema at the next higher level</p>
<ul>
<li><p>It can be explained using the three-schema architecture</p></li>
<li><p>Data independence:</p></li>
</ul>
</div><div class="column" style="width:40%;">
<p><img data-src="imgs/slides194.png"></p>
</div>
</div>
</section>

<section id="data-lakehouse-armbrust2021lakehouse" class="title-slide slide level1 center">
<h1>Data Lakehouse <span class="citation" data-cites="armbrust2021lakehouse">(<a href="#/references" role="doc-biblioref" onclick="">Armbrust et al. 2021</a>)</span></h1>

<img data-src="imgs/slides195.png" class="r-stretch quarto-figure-center"><p class="caption">From DWH to Data Lakehouse</p></section>

<section id="data-lakehouse-armbrust2021lakehouse-1" class="title-slide slide level1 center">
<h1>Data Lakehouse <span class="citation" data-cites="armbrust2021lakehouse">(<a href="#/references" role="doc-biblioref" onclick="">Armbrust et al. 2021</a>)</span></h1>
<p><strong>1st generation systems</strong>: data warehousing started with helping business decision-makers get analytical insights</p>
<ul>
<li>Data in warehouses (DWH) would be written with <em>schema-on-write</em> to ensure that data is optimized for BI applications
<ul>
<li><em>Schema on write</em> is defined as creating a schema for data before writing into the database</li>
</ul></li>
<li>Several challenges
<ul>
<li>DWH typically couples compute and storage into an on-premises appliance
<ul>
<li>This forced enterprises to provision and pay for the peak of user load and data under management, very costly</li>
</ul></li>
<li>More and more datasets were completely unstructured, which DWHs could not store and query at all</li>
</ul></li>
</ul>
</section>

<section id="data-lakehouse-armbrust2021lakehouse-2" class="title-slide slide level1 center">
<h1>Data Lakehouse <span class="citation" data-cites="armbrust2021lakehouse">(<a href="#/references" role="doc-biblioref" onclick="">Armbrust et al. 2021</a>)</span></h1>
<p><strong>2nd generation</strong>: offloading all the raw data into data lakes</p>
<ul>
<li>The data lake is <em>schema-on-read</em> and stores any data at low cost
<ul>
<li><em>Schema on read</em> postpones the structuring of data to the time of analysis or reading</li>
</ul></li>
<li>From 2015 onwards, cloud data lakes, such as S3 and GCS, started replacing HDFS
<ul>
<li>Superior durability (often &gt;10 nines), geo-replication, and most importantly, extremely low cost</li>
</ul></li>
<li>The use of <em>open formats</em> also made data lake data directly accessible to a wide range of other analytics engines, such as machine learning systems
<ul>
<li>An <em>open file format</em> is a file format for storing digital data, defined by an openly published specification usually maintained by a standards organization, and which can be used and implemented by anyone.</li>
</ul></li>
<li>A small subset of data in the lake would later be ETLed to a downstream data warehouse
<ul>
<li><em>Problems</em>?</li>
</ul></li>
</ul>
</section>

<section id="dataset-search-for-data-discovery-augmentation-and-explanation" class="title-slide slide level1 center">
<h1>Dataset Search for Data Discovery, Augmentation, and Explanation</h1>
<p><strong>Is there a real need for many unstructured and integrated datasets?</strong></p>
<ul>
<li>Recent years have seen an explosion in our ability to collect and catalog data about our environment and society</li>
<li>Governments and organizations are increasingly making data available on the Web and in various repositories and data lakes</li>
<li><em>This opportunity is often missed due to a central technical barrier</em>: it is currently nearly impossible for domain experts to weed through the vast amount of available information to discover datasets that are needed for their specific application</li>
</ul>
<p>Juliana Freire, keynote @ EDBT 2023</p>
</section>

<section id="data-lakehouse-2" class="title-slide slide level1 center">
<h1>Data Lakehouse</h1>
<p>A two-tier architecture is highly complex for users</p>
<ul>
<li>(Optional) Data is first <em>ETLed</em> into lakes, …</li>
<li>… and then <em>ELTed</em> into warehouses</li>
<li>Enterprise use cases now include advanced analytics such as machine learning, for which warehouses are not ideal</li>
</ul>
<p>(Some) main problems:</p>
<ul>
<li><em>Reliability</em>: keeping the data lake and warehouse consistent is difficult and costly</li>
<li><em>Staleness</em>: the data in the warehouse is stale compared to that of the data lake, with new data frequently taking days to load</li>
<li><em>Limited support for advanced analytics</em>: businesses want to ask predictive questions using their warehousing data
<ul>
<li>E.g., “Which customers should I offer discounts to?”</li>
<li>E.g., process large datasets using complex non-SQL code</li>
</ul></li>
</ul>
</section>

<section id="data-lakehouse-3" class="title-slide slide level1 center">
<h1>Data Lakehouse</h1>
<p>Idea</p>
<ul>
<li><em>Store data in a low-cost object store</em> using an open file format such as Apache Parquet</li>
<li><em>Implement a transactional metadata layer</em> on top of the object store that defines which objects are part of a table version</li>
<li><em>Implement management features</em> within the metadata layer</li>
</ul>

<img data-src="imgs/slides196.png" class="r-stretch quarto-figure-center"><p class="caption">Lakehouse</p></section>

<section id="data-lakehouse-4" class="title-slide slide level1 center">
<h1>Data Lakehouse</h1>
<p>Metadata alone is insufficient to achieve good performance, challenges:</p>
<ul>
<li><em>Data warehouses use several techniques to get state-of-the-art performance</em>
<ul>
<li>Storing hot data on fast devices such as SSDs, maintaining statistics, building efficient indexes, etc.</li>
</ul></li>
<li><em>In a data lake</em>, but it is possible to implement other optimizations that leave the data files unchanged</li>
<li>Most <em>cloud object stores are merely key-value stores</em>, with no cross-key consistency</li>
<li><em>Multi-object updates are not atomic</em>, there is no isolation between queries
<ul>
<li>If a query updates multiple objects in a table, readers will see partial updates as the query updates each object individually</li>
</ul></li>
<li>For large tables with millions of objects, <em>metadata operations are expensive</em>
<ul>
<li>The latency of cloud object stores is so much higher that these data-skipping checks can take longer than the actual query</li>
</ul></li>
</ul>
</section>

<section id="delta-lake-armbrust2020delta" class="title-slide slide level1 center">
<h1>Delta Lake <span class="citation" data-cites="armbrust2020delta">(<a href="#/references" role="doc-biblioref" onclick="">Armbrust et al. 2020</a>)</span></h1>
<div class="columns">
<div class="column" style="width:50%;">
<p>Delta Lake uses a <strong>transaction log</strong> and stores data into Apache Parquet for significantly faster metadata operations for large tabular datasets</p>
<ul>
<li>E.g., quickly search billions of table partitions</li>
<li>The log is stored in the <code>_delta_log</code> subdirectory</li>
<li>The delta log contains
<ul>
<li>Sequence of <em>commits</em> JSON objects with increasing, zero-padded numerical IDs to store the log records</li>
<li>Occasional <em>checkpoints</em> for specific log objects that summarize the log up to that point</li>
</ul></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imgs/deltalake1.png"></p>
<figcaption><a href="https://www.databricks.com/blog/2019/08/21/diving-into-delta-lake-unpacking-the-transaction-log.html">Delta Lake transaction log</a></figcaption>
</figure>
</div>
</div>
</div>
</section>

<section id="delta-lake" class="title-slide slide level1 center">
<h1>Delta Lake</h1>
<p>Changes are recorded as ordered, atomic commits in the transaction log.</p>
<ul>
<li>Each commit is written as a JSON file, starting with <code>000000.json</code>.</li>
<li>Additional changes to the table generate subsequent JSON files in ascending numerical order</li>
<li>Each log record object (e.g., <code>000003.json</code>) contains an array of actions to apply to the previous table version</li>
</ul>
<p>Whenever a user modifies a table (such as an INSERT, UPDATE, or DELETE), Delta Lake breaks that operation down into a series of discrete steps composed of one or more of the actions below.</p>
<ul>
<li>Add file - adds a data file.</li>
<li>Remove file - removes a data file.</li>
<li>Update metadata - Updates the table’s metadata (e.g., changing the table’s name, schema, or partitioning).</li>
<li>Set transaction - Records that a structured streaming job has committed a micro-batch with the given ID.</li>
<li>Change protocol - enables new features by switching the Delta Lake transaction log to the newest software protocol.</li>
<li>Commit info - Contains information around the commit, which operation was made, from where, and when.</li>
</ul>
</section>

<section id="delta-lake-1" class="title-slide slide level1 center">
<h1>Delta Lake</h1>
<div class="columns">
<div class="column" style="width:50%;">
<p>Once we have made several commits to the transaction log, Delta Lake saves a <strong>checkpoint file</strong> in Parquet format in <code>_delta_log</code></p>
<ul>
<li>Delta Lake automatically generates checkpoints as needed to maintain good read performance.</li>
<li>Checkpoints store all the non-redundant actions in the table’s log up to a certain log record ID, in Parquet format</li>
<li>Some sets of actions are redundant and can be removed</li>
<li>Read the <em>last checkpoint</em> object in the table’s log directory, if it exists, to obtain a recent checkpoint ID</li>
</ul>
</div><div class="column" style="width:50%;">
<p><img data-src="imgs/deltalake2.png"></p>
</div>
</div>
</section>

<section id="delta-lake-2" class="title-slide slide level1 center">
<h1>Delta Lake</h1>
<div class="columns">
<div class="column" style="width:50%;">
<p>Checkpoints save the entire state of the table at a point in time.</p>
<p>A “shortcut” to reproducing a table’s state that allows Spark to avoid reprocessing what could be thousands of tiny, inefficient JSON files.</p>
<p>Spark runs a <code>listFrom v</code> operation to view all files in the transaction log, starting from <code>v</code></p>
<ul>
<li>… quickly skips to the newest checkpoint file,</li>
<li>… only processes JSON commits made since the most recent checkpoint file was saved.</li>
</ul>
</div><div class="column" style="width:50%;">
<p><img data-src="imgs/deltalake3.png"></p>
</div>
</div>
<p>Imagine that we’ve created commits up to <code>000007.json</code> and that Spark has cached this version of the table in memory.</p>
<ul>
<li>In the meantime, other writers have written new data to the table, adding commits up to <code>0000012.json</code>.</li>
<li>To incorporate these new transactions, Spark runs a <code>listFrom</code> version 7 operation to see the new changes to the table.</li>
<li>Rather than processing all of the intermediate JSON files …</li>
<li>… Spark skips ahead to the most recent checkpoint file since it contains the entire state of the table at commit <code>#10</code>.</li>
</ul>
</section>

<section id="delta-lake-3" class="title-slide slide level1 center">
<h1>Delta Lake</h1>
<p><strong>Time Travel</strong></p>
<ul>
<li>Every table is the result of the sum total of all of the commits recorded in the Delta Lake transaction log.</li>
<li>The log provides a step-by-step instruction guide, detailing how to get from the table’s original state to its current state.</li>
<li>Recreate the state of a table at any point in time by starting with an original table, and processing only commits made before that point.</li>
</ul>
<p><strong>Data Lineage and Debugging</strong></p>
<ul>
<li>The transaction log offers users a verifiable data lineage that is useful for governance, audit, and compliance purposes.</li>
<li>It can also be used to trace the origin of an inadvertent change or a bug in a pipeline back to the exact action that caused it.</li>
</ul>
</section>

<section id="delta-lake-4" class="title-slide slide level1 center">
<h1>Delta Lake</h1>
<p><strong>Optimize</strong>: Delta Lake can improve the speed of read queries from a table by coalescing small files into larger ones.</p>
<ul>
<li><em>Bin-packing optimization</em> is idempotent, meaning that if it is run twice on the same dataset, the second run has no effect.</li>
<li><em>Bin-packing</em> aims to produce evenly-balanced data files with respect to their size on disk, but not necessarily a number of tuples.
<ul>
<li>However, the two measures are most often correlated.</li>
</ul></li>
<li>Python and Scala APIs for executing OPTIMIZE operations are available from Delta Lake 2.0 and above.</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb1-1"><a href=""></a><span class="im">from</span> delta.tables <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-2"><a href=""></a>deltaTable <span class="op">=</span> DeltaTable.forPath(spark, pathToTable)  <span class="co"># For path-based tables</span></span>
<span id="cb1-3"><a href=""></a><span class="co"># For Hive metastore-based tables: deltaTable = DeltaTable.forName(spark, tableName)</span></span>
<span id="cb1-4"><a href=""></a>deltaTable.optimize().executeCompaction()</span>
<span id="cb1-5"><a href=""></a><span class="co"># If you have a large amount of data and only want to optimize a subset of it, you can specify an optional partition predicate using `where`</span></span>
<span id="cb1-6"><a href=""></a>deltaTable.optimize().where(<span class="st">"date='2021-11-18'"</span>).executeCompaction()</span></code></pre></div>
<p><em>Auto compaction</em> combines small files within Delta table partitions to automatically reduce small file problems.</p>
<ul>
<li>Occur after a write to a table has succeeded and runs synchronously on the cluster that has performed the write.</li>
<li>Compact files that haven’t been compacted previously.</li>
</ul>
</section>

<section id="delta-lake-5" class="title-slide slide level1 center">
<h1>Delta Lake</h1>
<p>Example of a <em>write transaction</em>: read the data at table version <code>r</code> and attempt to write log record <code>r+1</code></p>
<ul>
<li>Read data at table version <code>r</code>, if required combine previous checkpoint and further log records</li>
<li>Write any new data into new files in the correct data directories, generating the object names using GUIDs.
<ul>
<li>This step can happen in parallel</li>
<li>At the end, these objects are ready to be referenced in a new log record.</li>
</ul></li>
<li>Attempt to write the transaction’s log record into the <code>r+1.json</code> log object, if no other client has written this object
<ul>
<li><em>This step needs to be atomic</em>: only 1 client should succeed.</li>
<li>If the step fails, the transaction can be retried; depending on the query’s semantics (optimistic concurrency)</li>
</ul></li>
<li>Optionally, write a new <code>.parquet</code> checkpoint for log record <code>r+1</code></li>
</ul>
<p>Not all large-scale storage systems have an atomic put operation</p>
<ul>
<li>Google Cloud Storage and Azure Blob Store support atomic put-if-absent operations</li>
<li>HDFS, we use atomic renames to rename a temporary file to the target name</li>
<li>Amazon S3 needs ad-hoc protocols</li>
</ul>
</section>

<section id="delta-lake-6" class="title-slide slide level1 center">
<h1>Delta Lake</h1>
<p>Check the scalability with respect to the length of the log</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb2-1"><a href=""></a>i <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb2-2"><a href=""></a><span class="cf">while</span> i <span class="op">&lt;</span> <span class="dv">20000</span>:</span>
<span id="cb2-3"><a href=""></a>    <span class="cf">if</span> i <span class="op">%</span> <span class="dv">10</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb2-4"><a href=""></a>        spark.sql(<span class="st">"select sum(quantity) from lineitem"</span>)  <span class="co"># Read the whole fact</span></span>
<span id="cb2-5"><a href=""></a>    spark.sql(<span class="st">"insert (500K tuple) into lineitem"</span>)  <span class="co"># Append new tuples</span></span>
<span id="cb2-6"><a href=""></a>    <span class="cf">if</span> i <span class="op">%</span> <span class="dv">100</span> <span class="op">==</span> <span class="dv">0</span>: OPTIMIZE</span>
<span id="cb2-7"><a href=""></a>    i <span class="op">+=</span> <span class="dv">1</span></span></code></pre></div>

<img data-src="imgs/deltalake4.png" class="r-stretch quarto-figure-center"><p class="caption">Scalability</p></section>

<section id="delta-lake-7" class="title-slide slide level1 center">
<h1>Delta Lake</h1>

<img alt="Scaling out performance" src="imgs/deltalake5.png" class="center r-stretch"></section>

<section id="lakehouse" class="title-slide slide level1 center">
<h1>Lakehouse</h1>
<p>(SQL) Format-independent optimizations are</p>
<ul>
<li><em>Caching</em>: when using a transactional metadata layer such as Delta Lake, it is safe for a Lakehouse system to cache files from the cloud object store on faster storage devices such as SSDs and RAM on the processing nodes</li>
<li><em>Auxiliary data</em>: maintain column min-max statistics for each data file in the table within the same Parquet file used to store the transaction log, which enables data skipping optimizations when the base data is clustered by particular columns</li>
<li><em>Data layout</em>:
<ul>
<li><em>Record ordering</em>: which records are clustered together and hence easiest to read together, e.g.&nbsp;ordering records using individual dimensions or space-filling curves such as Z-order</li>
<li><em>Compression strategies</em> differently for various groups of records or other strategies</li>
</ul></li>
</ul>
</section>

<section id="references" class="title-slide slide level1 smaller scrollable">
<h1>References</h1>
<div class="quarto-auto-generated-content">
<div class="footer footer-default">
<p>Matteo Francia - Big Data and Cloud Platforms (Module 2) - A.Y. 2024/25</p>
</div>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-armbrust2020delta" class="csl-entry" role="listitem">
Armbrust, Michael, Tathagata Das, Liwen Sun, Burak Yavuz, Shixiong Zhu, Mukul Murthy, Joseph Torres, et al. 2020. <span>“Delta Lake: High-Performance ACID Table Storage over Cloud Object Stores.”</span> <em>Proceedings of the VLDB Endowment</em> 13 (12): 3411–24.
</div>
<div id="ref-armbrust2021lakehouse" class="csl-entry" role="listitem">
Armbrust, Michael, Ali Ghodsi, Reynold Xin, and Matei Zaharia. 2021. <span>“Lakehouse: A New Generation of Open Platforms That Unify Data Warehousing and Advanced Analytics.”</span> In <em>Proceedings of CIDR</em>, 8:28.
</div>
<div id="ref-couto2019mapping" class="csl-entry" role="listitem">
Couto, Julia, Olimar Teixeira Borges, Duncan D Ruiz, Sabrina Marczak, and Rafael Prikladnicki. 2019. <span>“A Mapping Study about Data Lakes: An Improved Definition and Possible Architectures.”</span> In <em>SEKE</em>, 453–578.
</div>
<div id="ref-mansouri2017data" class="csl-entry" role="listitem">
Mansouri, Yaser, Adel Nadjaran Toosi, and Rajkumar Buyya. 2017. <span>“Data Storage Management in Cloud Environments: Taxonomy, Survey, and Future Directions.”</span> <em>ACM Computing Surveys (CSUR)</em> 50 (6): 1–51.
</div>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="06-storage_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="06-storage_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="06-storage_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="06-storage_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="06-storage_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="06-storage_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="06-storage_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="06-storage_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="06-storage_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="06-storage_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: true,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'bottom-right',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1100,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>